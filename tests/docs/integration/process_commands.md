# プロセス管理コマンド結合テスト仕様

## 概要

プロセス管理コマンドの結合テストでは、以下の機能をテストします：

- データベースへのプロセス情報の保存と取得
- プロセスの作成、表示、更新、削除の一連の流れ
- バリデーションエラーの処理
- プロセスインスタンスとの連携

この結合テストでは実際のデータベースアクセスを伴う処理をテストし、コマンドの機能が想定通りに動作することを確認します。

## テスト環境

- 一時的なSQLiteデータベースを使用
- 各テスト実行時にデータベースを初期化
- conftest.pyによる共通セットアップの利用

## テストケース

### `test_create_and_list`

**目的**: プロセスの作成と一覧表示の機能が正しく動作することを確認する

**手順**:
1. プロセスを2件作成する
2. list コマンドで一覧を表示する

**期待される結果**:
- 作成コマンドの終了コード: 0
- 作成コマンドの出力に "プロセスを作成しました" が含まれること
- 一覧表示コマンドの終了コード: 0
- 一覧に作成した2件のプロセスが含まれること
- プロセスIDが表示されること
- プロセス名が表示されること

### `test_show_process`

**目的**: プロセスの詳細表示機能が正しく動作することを確認する

**手順**:
1. プロセスを作成する
2. show コマンドで詳細を表示する

**期待される結果**:
- 詳細表示コマンドの終了コード: 0
- 出力にプロセスIDが含まれること
- 出力にプロセス名が含まれること
- 出力にプロセスの説明が含まれること
- 出力に作成日時が含まれること

### `test_update_process`

**目的**: プロセスの更新機能が正しく動作することを確認する

**手順**:
1. プロセスを作成する
2. update コマンドでプロセス名と説明を更新する
3. show コマンドで更新されたことを確認する

**期待される結果**:
- 更新コマンドの終了コード: 0
- 更新コマンドの出力に "プロセスを更新しました" が含まれること
- 詳細表示で更新後のプロセス名が表示されること
- 詳細表示で更新後の説明が表示されること

### `test_simple_delete`

**目的**: プロセスの削除機能が正しく動作することを確認する

**手順**:
1. プロセスを作成する
2. delete コマンドでプロセスを削除する
3. list コマンドで削除されたことを確認する

**期待される結果**:
- 削除コマンドの終了コード: 0
- 削除コマンドの出力に "プロセスを削除しました" が含まれること
- 一覧表示で削除したプロセスが表示されないこと

### `test_delete_with_force`

**目的**: プロセスのforce削除機能が正しく動作することを確認する

**手順**:
1. プロセスを作成する
2. プロセスインスタンスを作成する（このプロセスを参照）
3. 通常の削除コマンドを実行する（失敗するはず）
4. --force オプション付きで削除コマンドを実行する
5. list コマンドで削除されたことを確認する

**期待される結果**:
- 通常削除コマンドの終了コード: 1
- 通常削除コマンドの出力に "プロセスインスタンスが存在するため削除できません" などのエラーメッセージが含まれること
- force削除コマンドの終了コード: 0
- force削除コマンドの出力に "プロセスを強制削除しました" が含まれること
- 一覧表示で削除したプロセスが表示されないこと

### `test_error_handling`

**目的**: エラー処理が正しく機能することを確認する

**手順**:
1. 存在しないプロセスIDを指定して show コマンドを実行する
2. 存在しないプロセスIDを指定して update コマンドを実行する
3. 存在しないプロセスIDを指定して delete コマンドを実行する

**期待される結果**:
- 各コマンドの終了コード: 1
- 各コマンドの出力に "プロセスが見つかりません" などのエラーメッセージが含まれること 